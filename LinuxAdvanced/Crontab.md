# 任务计划

## 基本介绍

在Linux中，可以使用crontab来设置和管理任务计划。crontab是一个用于定期执行命令或脚本的工具，可以按照指定的时间间隔自动运行任务。

以下是一些常见的使用crontab来设置任务计划的步骤：

1. 查看现有的crontab任务：使用以下命令可以查看当前用户的crontab任务列表：

   ```
   crontab -l
   ```

2. 编辑或创建新的crontab任务：使用以下命令可以编辑或创建一个新的crontab任务：

   ```
   crontab -e
   ```

   在打开的编辑器中，每行代表一个任务计划，格式如下：

   ```
   * * * * * command
   ```

   - 第一个星号表示分钟（0-59）
   - 第二个星号表示小时（0-23）
   - 第三个星号表示日期（1-31）
   - 第四个星号表示月份（1-12）
   - 第五个星号表示星期几（0-7，其中0和7都表示星期日）

   例如，如果要在每天的早上8点运行一个脚本，可以使用以下行：

   ```
   0 8 * * * /path/to/script.sh
   ```

   编辑完成后，保存并关闭编辑器。

3. 删除crontab任务：如果要删除当前用户的所有crontab任务，可以使用以下命令：

   ```
   crontab -r
   ```

   注意：这将删除当前用户的所有crontab任务，请谨慎使用。

这些是设置和管理任务计划的基本步骤。可以根据具体的需求调整crontab任务的设置。另外，还可以使用其他工具，如anacron或systemd-timer，来管理更复杂的任务计划。请参考相关文档和手册以获取更多信息和示例。

## 优先级说明	

这五个时间单位的优先级从左到右依次降低。根据这五个时间单位的取值，可以设置不同的定时任务。例如：

- 如果在分钟、小时、日期、月份和星期几的位置上都使用了星号（*），表示任务将在每分钟都执行。
- 如果在分钟位置上使用了特定的数字，而其他位置上使用了星号（*），表示任务将在每小时的特定分钟执行。
- 如果在小时位置上使用了特定的数字，而其他位置上使用了星号（*），表示任务将在每天的特定小时执行。
- 如果在日期位置上使用了特定的数字，而其他位置上使用了星号（*），表示任务将在每月的特定日期执行。
- 如果在月份位置上使用了特定的数字，而其他位置上使用了星号（*），表示任务将在每年的特定月份执行。
- 如果在星期几位置上使用了特定的数字，而其他位置上使用了星号（*），表示任务将在每周的特定星期几执行。

请注意，星号（*）表示通配符，意味着该时间单位的所有取值都适用。而特定的数字表示具体的取值，例如1代表1号，2代表2点等。

根据具体需求，可以根据时间单位的优先级来设置crontab任务的时间间隔。请确保设置正确的时间间隔，以确保任务按预期执行。

每分钟，用 *

每2分钟，则用*/2

每5分钟，则用*/5

其他依次类推，绝大部分任务都是在分钟和小时2个参数进行调整。

## 主要用途

1.定时切割日志，删除文件

nginx等web服务器的日志轮询，然后删除过期的日志等

```
#凌晨1点执行,可以跟具体的命令，也可以跟脚本路径，注意环境变量有效性
* 1 * * * * Command
```

2.检查进程存活

常用于各种服务，比如zk，kafka，等中间件的进程监控，如果不正常则执行启动

```
#每2分钟检查一次进程是否正常，如果不正常则执行后续启动或其他动作
*/2 * * * * Command
```

3.定期备份

用于定期备份数据库或者备份业务文件

```
#每天凌晨5点做备份数据库，或者同步文件操作
* 5 * * * Command
```

